# 训练字符级别的语言模型，使用《神雕侠侣》进行训练，期望让模型编写武侠小说
根据https://github.com/hzy46/Char-RNN-TensorFlow 的代码进行改写，如有侵权，请及时与本人联系。
本人对架构进行了整理，包含三个模块：
数据处理模块read_util.py，模型模块model.py，运行模块run.py

以诗词语料为训练数据，训练之后的生成结果：
Reading model parameters from train_dir/poetry/generate.ckpt-3400
> 
风花入山里，风下白云秋。
不是无人事，无时一未知。
山山无处去，春月入山风。
不见青山客，无来独不知。
不怜山上去，相见一人稀。
一去何年事，何来此处时。
一心如此去，相见白云时。
日日春中去，春山夜未多。
何年不为去，相见故人期。
一客不相思，一君何处情。
不应知此别，此处有人归。
不问山风上，无来有不同。
不知何处在，何事不知人。
一客多何处，人人一自归。
山光开白草，秋雨夜中深。
日暮秋花起，山花夜落春。
山风秋上月，风雨落山春。
一客长无去，何年不可知。
山风不不尽，一月自相逢。
日暮春风远，秋风夜月深。
山光生白草，云上水风飞。
何处无人事，何人有此情。
何年不为此，不见不知心。


以《神雕侠侣》为训练数据，过程为：
训练过程
python run.py \
--train_dir train_dir \
--model_name novel \
--batch_size 32 \
--num_layers 2 \
--use_embedding \
--use_sample_loss \
--set_learning_rate 0.01 \
--learning_rate_decay_factor 0.5 \
--input_file data/The_Return_of_the_Condor_Heroes.txt \
--max_train_steps 10000 \
--steps_per_sentence_length 1000 \
--steps_per_checkpoint 100


预测过程
python run.py \
--train_dir /Users/baihai/projects/char_lm/train_dir \
--model_name novel_4 \
--use_embedding \
--sampling \
--sample_length 500
Reading model parameters from /Users/baihai/projects/char_lm/train_dir/novel_4/generate.ckpt-46000
> 
不由得不知，只是他不知是何以，我也有一个人，这一招却要不知。”
杨过道：“不错，我也不知是甚么？”
郭靖心想：“那你不是你，这一句，是我这么不是？”说着伸手向他背上刺去，

心想：“我是他
们不能，我们不知你不会。”小龙女微笑道：“我是我们

了。”郭芙道：“你说我的不会，不能说话。”杨过道：“我是你的一个人，你不知我不知我的，我也不会
的，我不能不肯说？”
杨过见她不答，心想：“我这一个人的一个人，你也不能不是我的。”
杨过听她说话，心念一动。
郭芙道：“那你
我也说得甚么？”
杨过见他一惊，但见郭襄一怔，心中怦怦乱跳，心中暗想，不免不禁不忍，但见郭襄的
手中一股
鲜血淋漓，不由得脸颊中充满满满了一个
一句。他一怔，道：“你不能不肯去，这么不是你？”杨过道：“你说他不肯再去？”
小龙女道：“我这些
人是谁？”郭芙道：“你是我的
一个，我是我是你。”郭芙笑道：“你说你这么一句？”说着伸手抓起，只见他脸上大红，
一个一个
人，心中不动，只道：“我不肯说了，我是你的事，我是不是。”
郭芙心想：“你们这些
人是他不会。”
黄药师道：“你这么好，我不知是甚么？”杨过道：“我是我不是？”杨过道：



个人体会：
（1）对于诗词语料，其语法规律性比较强，字符之间的依赖长度比较短，且依赖的规律性也很强，模型很容易学习到其生成模式；但是对于长篇小说，语法比较随意，依赖长度的变化行比较大，模型学习起来比较困难
（2）对于对准确性比较高的应用，还是应该在模型中加入一些认为的规则进行约束，才有可能得到更可用的结果